## Permissions

### Declaration

@typexs/roles-api

in implemented in IActivator or IBootstrap

```js
export class Activator implements IActivator, IPermissions {

    permissions(): Promise<IPermissionDef[]> | IPermissionDef[] {
        return [
            {
                permission: 'access some permission'
            },
            {
                permission: 'some other permission',
                handle: (user:any, obj:any) => {
                    if(_.has(obj, 'user') && obj.user === user) {
                        return true;
                    }
                    return false;
                }
            }
        ];
    }

}
```

### Check permissions

```js

const credentials = Container.get(Credentials)

const entity = new Room();
const user = GetCurrentUser();

if(credentials.access('access user entity', user, entity)){
    // access allowed
}else{
    // access forbidden
}


```

```js

const fieldAccessPermission = {
    getPermission() {
        return 'field restricted access';
    }
}

const showPermission = {
    getPermission() {
        return 'show restricted value';
    }
// TODO subpermissions?
    getHandle(){
        return (holder: IRolesHolder, resource: ISecuredResource) => {
            const permissions = Access.getPermissionFromRoles(holder.getRoles())
            if(!permissions.includes('field restricted access')){
                resource['restriced'] = '###HIDDEN###';
            }
            return true;
        };
    }
};



const obj = {
    name: 'jan',
    restricted: 'secretcode',

    getPermissions(){
        return [
            new BasicPermission('show restricted value')
        ];
    }
};

const userWithFieldAcces = {
    getRoles(){
        return [
            {
                getPermissions(){
                    return [
                        new BasicPermission('show restricted value'),
                        new BasicPermission('field restricted access')
                    ];
                }
            }

        ];
    }
};

const userWithoutFieldAcces = {
    getRoles(){
        return [
            {
                getPermissions(){
                    return [
                        new BasicPermission('show restricted value'),
                    ];
                }
            }

        ];
    }
};


```




